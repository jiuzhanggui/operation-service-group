(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-206914d0","chunk-71a6cabe","chunk-34f5fc16","chunk-3021617b","chunk-1d06f862"],{"0e63":function(t,e,a){},"391e":function(t,e,a){"use strict";a.d(e,"f",(function(){return o})),a.d(e,"a",(function(){return i})),a.d(e,"e",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"g",(function(){return u}));var n=a("b775");function o(t){return Object(n["a"])({url:"operation/degradation/degradation.list.get",method:"post",data:t})}function i(t){return Object(n["a"])({url:"operation/degradation/degradation.task.add",method:"post",data:t})}function s(t){return Object(n["a"])({url:"operation/degradation/degradation.task.delete",method:"post",data:t})}function r(t){return Object(n["a"])({url:"operation/degradation/degradation.task.control",method:"post",data:t})}function l(t){return Object(n["a"])({url:"operation/degradation/degradation.task.timer",method:"post",data:t})}function c(t){return Object(n["a"])({url:"operation/degradation/degradation.task.canceltimer",method:"post",data:t})}function u(t){return Object(n["a"])({url:"operation/degradation/degradation.log.get",method:"post",data:t})}},5414:function(t,e,a){},5424:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"定时降级",visible:t.isOpenTimeDialog,width:"30%"},on:{"update:visible":function(e){t.isOpenTimeDialog=e},close:t.closeDialog}},[a("el-form",{attrs:{model:t.timedInfo}},[a("el-row",[a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"任务名称："}},[a("el-input",{staticStyle:{width:"35%"},attrs:{disabled:"",autocomplete:"off"},model:{value:t.timedInfo.taskName,callback:function(e){t.$set(t.timedInfo,"taskName",e)},expression:"timedInfo.taskName"}})],1)],1),a("el-row",[a("el-col",{attrs:{span:18}},[a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"开启降级时间："}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":t.pickerOptions,placeholder:"选择日期时间"},model:{value:t.openTime,callback:function(e){t.openTime=e},expression:"openTime"}})],1)])],1),a("el-col",{attrs:{span:6}},[a("el-button",{staticClass:"button",attrs:{type:"info"},on:{click:t.cancelTaskTimer}},[t._v("取消定时任务")])],1)],1),a("el-row",[a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"恢复降级时间："}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetime","picker-options":t.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.closeTime,callback:function(e){t.closeTime=e},expression:"closeTime"}})],1)])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),a("el-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.setTimedTask}},[t._v("确 定")])],1)],1)},o=[],i=a("391e"),s={name:"DegradationTimerDialog",props:{taskName:{type:String,default:""}},data:function(){return{isOpenTimeDialog:!0,openTime:"",closeTime:"",timedInfo:{taskName:this.taskName,startTime:"",endTime:""},pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()}},value:[]}},methods:{closeDialog:function(){this.$emit("timerDialogController")},refresh:function(){this.$emit("refreshTable")},setTimedTask:function(){var t=this;""!==this.closeTime||""!==this.openTime?(this.timedInfo.startTime=this.openTime,this.timedInfo.endTime=this.closeTime,Object(i["d"])(this.timedInfo).then((function(e){200===e.code?(t.$message({type:"success",message:e.msg,center:!0}),t.closeDialog(),t.refresh()):t.$message({type:"warning",message:e.msg,center:!0})}))):this.$message({type:"warning",message:"开始结束时间不能都为空",center:!0})},getLastTime:function(){},cancelTaskTimer:function(){var t=this;this.$confirm("取消定时任务, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["b"])(t.timedInfo).then((function(e){200===e.code?(t.$message({type:"success",message:e.msg,center:!0}),t.refresh()):t.$message({type:"warning",message:e.msg,center:!0})}))})).catch((function(){t.$message({type:"info",message:"已取消操作",center:!0})}))}}},r=s,l=a("2877"),c=Object(l["a"])(r,n,o,!1,null,"e556684e",null);e["default"]=c.exports},"5f01":function(t,e,a){"use strict";a("f00c")},b6f0:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-pagination",{attrs:{background:"","current-page":t.nowCurrentPage,"page-size":this.pageRequest.pageSize,layout:"prev, pager, next",total:t.nowTotal},on:{"update:currentPage":function(e){t.nowCurrentPage=e},"update:current-page":function(e){t.nowCurrentPage=e},"current-change":t.currentChange}})},o=[],i=(a("a9e3"),a("e9c4"),{name:"Paging",props:{total:{type:Number,default:0}},watch:{total:function(t,e){this.nowTotal=t}},data:function(){return{nowTotal:0,nowCurrentPage:0,pageRequest:{startIndex:0,pageSize:10}}},created:function(){this.$emit("getPageRequest",JSON.stringify(this.pageRequest))},methods:{currentChange:function(t){this.nowCurrentPage=t,this.pageRequest.startIndex=(t-1)*this.pageRequest.pageSize,this.$emit("getPageRequest",JSON.stringify(this.pageRequest))},clearCurrentPage:function(t){t&&(this.nowCurrentPage=this.nowCurrentPage-1)}}}),s=i,r=(a("5f01"),a("2877")),l=Object(r["a"])(s,n,o,!1,null,"5ab54985",null);e["default"]=l.exports},c3d6:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"降级日志",visible:t.isOpenLogDialog,width:"45%"},on:{"update:visible":function(e){t.isOpenLogDialog=e},close:t.closeDialog}},[a("el-row",{staticStyle:{"text-align":"left"}},[t._v(" 任务名称 "),a("el-input",{staticStyle:{width:"25%"},attrs:{disabled:"",autocomplete:"off"},model:{value:t.taskInfo.taskName,callback:function(e){t.$set(t.taskInfo,"taskName",e)},expression:"taskInfo.taskName"}})],1),a("el-row",{staticStyle:{"text-align":"left"}},[a("el-table",{attrs:{size:"small","current-row-key":"id",data:t.logList,stripe:"","highlight-current-row":""}},[t._v("--\x3e "),a("el-table-column",{attrs:{prop:"gmtCreate",label:"任务时间",align:"left",width:"200%"}}),a("el-table-column",{attrs:{prop:"content",label:"任务日志",align:"left"}})],1),a("Paging",{ref:"paging",attrs:{total:t.nowTotal},on:{getPageRequest:t.getPageRequest}})],1)],1)},o=[],i=a("b6f0"),s=a("391e"),r={name:"DegradationLogDialog",props:{taskName:{type:String,default:""}},components:{Paging:i["default"]},data:function(){return{isOpenLogDialog:!0,nowTotal:0,taskInfo:{taskName:this.taskName,startIndex:0,pageSize:0},logList:[]}},methods:{closeDialog:function(){this.$emit("logDialogController")},getPageRequest:function(t){var e=JSON.parse(t);this.taskInfo.startIndex=e.startIndex,this.taskInfo.pageSize=e.pageSize,this.getDegradationTaskLogRecord()},getDegradationTaskLogRecord:function(){var t=this;Object(s["g"])(this.taskInfo).then((function(e){t.logList=e.data.content,t.nowTotal=e.data.total}))}}},l=r,c=a("2877"),u=Object(c["a"])(l,n,o,!1,null,"58fbb340",null);e["default"]=u.exports},c66c:function(t,e,a){"use strict";a("0e63")},d957:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.degradationList,"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},"row-class-name":t.tableRow,stripe:""},on:{"row-click":t.onRowClick}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"100%"}}),a("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"200%"}}),a("el-table-column",{attrs:{prop:"description",label:"描述",width:"500%"}}),a("el-table-column",{attrs:{prop:"timerStatus",label:"定时任务启用状态",width:"250%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{staticClass:"degradation-tag",attrs:{type:0===e.row.timerStatus?"info":1===e.row.timerStatus?"success":"warning"}},[t._v(" "+t._s(0===e.row.timerStatus?"无定时任务":1===e.row.timerStatus?"定时任务已开启":"定时任务准备中")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"isOpenDegradationTask",label:"是否降级",width:"150%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-text":"开启","active-value":1,"active-color":"#13ce66","inactive-text":"恢复","inactive-value":0,"inactive-color":"#f4f4f5"},on:{change:function(a){return t.degradationControl(e.row)}},model:{value:e.row.switchStatus,callback:function(a){t.$set(e.row,"switchStatus",a)},expression:"scope.row.switchStatus"}})]}}])}),a("el-table-column",{attrs:{prop:"degradationOperation",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"button",attrs:{type:"success"},on:{click:function(a){return t.timerDialogController(e.row.name)}}},[t._v("定时降级")]),a("el-button",{staticClass:"button",attrs:{type:"success"},on:{click:function(a){return t.logDialogController(e.row.name)}}},[t._v("降级日志")]),a("el-button",{attrs:{type:"danger"},on:{click:function(a){return t.deleteDegradationTask(e.row.name)}}},[t._v("删除任务")])]}}])})],1),[a("el-button",{attrs:{type:"text"},on:{click:t.openMessageBox}})],t.isOpenTimerDialog?[a("DegradationTimerDialog",{ref:"degradationTimerDialog",attrs:{taskName:t.taskInfo.taskName},on:{timerDialogController:t.timerDialogController,refreshTable:t.refreshTable}})]:t._e(),t.isOpenLogDialog?[a("DegradationLogDialog",{ref:"log",attrs:{taskName:t.taskInfo.taskName},on:{logDialogController:t.logDialogController}})]:t._e()],2)},o=[],i=(a("ac1f"),a("5319"),a("b0c0"),a("f8f4")),s=a("5424"),r=a("c3d6"),l=a("391e"),c={name:"DegradationTable",components:{DegradationLogDialog:r["default"],DegradationTimerDialog:s["default"],Paging:i["default"]},data:function(){return{degradationList:[],isOpenTimerDialog:!1,isOpenLogDialog:!1,currentRowIndex:0,taskInfo:{taskName:"",switchStatus:""}}},props:{taskList:{default:[]}},watch:{taskList:function(t,e){this.degradationList=t;for(var a=0;a<this.degradationList.length;a++)if(null==t[a].startTime&&null==t[a].endTime)this.degradationList[a].timerStatus=0;else{var n=new Date(t[a].startTime.replace(/-/g,"/")).getTime(),o=new Date(t[a].endTime.replace(/-/g,"/")).getTime();if(null!=n&&null!=o)n>Date.now()||n<Date.now()&&o>Date.now()?this.degradationList[a].timerStatus=2:n<Date.now()&&o<Date.now()&&(this.degradationList[a].timerStatus=0);else{var i=0;i=null!=n?n:o,i<Date.now()?this.degradationList[a].timerStatus=2:this.degradationList[a].timerStatus=0}}}},methods:{refreshTable:function(t){this.$emit("queryTask",t)},deleteDegradationTask:function(t){var e=this;this.$confirm("此操作将删除该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.taskInfo.taskName=t,Object(l["e"])(e.taskInfo).then((function(t){200==t.code?(e.$message({message:t.msg,type:"success",center:!0}),e.refreshTable(e.currentRowIndex)):e.$message({message:t.msg,type:"error",center:!0})})).catch((function(){e.$message({type:"info",message:"已取消操作"}),t.switchStatus=+!t.switchStatus}))}))},degradationControl:function(t){this.openMessageBox(t)},openMessageBox:function(t){var e=this;this.$confirm("执行降级操作, 是否继续?","告警",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.taskInfo.switchStatus=t.switchStatus,e.taskInfo.taskName=t.name,Object(l["c"])(e.taskInfo).then((function(t){200===t.code?(e.$message({message:t.msg,type:"success",center:!0}),e.refreshTable(e.currentRowIndex)):(e.$message({message:t.msg,type:"warning",center:!0}),e.refreshTable(e.currentRowIndex))}))})).catch((function(){e.$message({type:"info",message:"已取消操作",center:!0}),e.refreshTable(e.currentRowIndex)}))},timerDialogController:function(t){this.taskInfo.taskName=t,this.isOpenTimerDialog=!this.isOpenTimerDialog},logDialogController:function(t){this.taskInfo.taskName=t,this.isOpenLogDialog=!this.isOpenLogDialog},tableRow:function(t){var e=t.row,a=t.rowIndex;e.row_index=a},onRowClick:function(t,e,a){this.currentRowIndex=t.row_index}}},u=c,g=(a("ee30"),a("2877")),d=Object(g["a"])(u,n,o,!1,null,"2f82123f",null);e["default"]=d.exports},ee30:function(t,e,a){"use strict";a("5414")},f00c:function(t,e,a){},f8f4:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-pagination",{attrs:{background:"","current-page":t.nowCurrentPage,"page-size":this.pageRequest.pageSize,layout:"prev, pager, next",total:t.nowTotal},on:{"update:currentPage":function(e){t.nowCurrentPage=e},"update:current-page":function(e){t.nowCurrentPage=e},"current-change":t.currentChange}})},o=[],i=(a("a9e3"),a("e9c4"),{name:"Paging",props:{total:{type:Number,default:0}},watch:{total:function(t,e){this.nowTotal=t}},data:function(){return{nowTotal:0,nowCurrentPage:0,pageRequest:{startIndex:0,pageSize:10}}},created:function(){this.$emit("getPageRequest",JSON.stringify(this.pageRequest))},methods:{currentChange:function(t){this.nowCurrentPage=t,this.pageRequest.startIndex=(t-1)*this.pageRequest.pageSize,this.$emit("getPageRequest",JSON.stringify(this.pageRequest))},clearCurrentPage:function(t){t&&(this.nowCurrentPage=this.nowCurrentPage-1)}}}),s=i,r=(a("c66c"),a("2877")),l=Object(r["a"])(s,n,o,!1,null,"e5d6e94c",null);e["default"]=l.exports}}]);